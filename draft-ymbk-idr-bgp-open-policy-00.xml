<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC4271 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4271.xml">
<!ENTITY RFC4486 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4486.xml">
<!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
<!ENTITY RFC5492 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5492.xml">
<!ENTITY I-D.ietf-grow-route-leak-problem-definition SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-grow-route-leak-problem-definition-03.xml">
<!ENTITY I-D.ietf-idr-route-leak-detection-mitigation SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-idr-route-leak-detection-mitigation-01.xml">
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" docName="draft-ymbk-idr-bgp-open-policy-00" ipr="trust200902">
 <front>

   <title abbrev="BGP Role"> BGP Open Marking Customer/Peer </title>

   <author fullname="Alexander Azimov" initials="A"
           surname="Azimov">
     <organization>Qrator Labs</organization>
     <address>
       <email>aa@qrator.net</email>
     </address>
   </author>

   <author fullname="Eugene Bogomazov" initials="E"
           surname="Bogomazov">
     <organization>Qrator Labs</organization>
     <address>
       <email>eb@qrator.net</email>
     </address>
   </author>

   <author fullname="Randy Bush" initials="R"
           surname="Bush">
     <organization>Internet Initiative Japan</organization>
     <address>
       <email>randy@psg.com</email>
     </address>
   </author>

   <date year="2016"/>
   <area>Routing</area>

   <keyword>Route leak</keyword>
   <keyword>BGP role</keyword>

   <abstract>
     <t>Route Leaks are propagation of BGP prefixes which violate
     assumptions of BGP topology relationships; e.g. passing a route
     learned from one peer to another peer or to a transit provider,
     passing a route learned from one transit provider to another
     transit provider or to a peer.  Today, approaches to leak
     prevention rely on marking routes according to some configuration
     options without any check of this configuration or enforcement that
     the two BGP speakers agree on the relationship.  This document
     enhances BGP Open to establish agreement of the (peer, customer,
     transit) relationship of the two BGP speakers to enforce
     appropriate configuration on both sides.</t>
   </abstract>

   <note title="Requirements Language">
     <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
     NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL"
     are to be interpreted as described in <xref target="RFC2119">RFC
     2119</xref> only when they appear in all upper case.  They may also
     appear in lower or mixed case as English words, without normative
     meaning. </t>
   </note>
 </front>

 <middle>
   <section title="Introduction" anchor="intro">
     <t> For the purposes of this document BGP route leaks are when BGP
     route was learned from transit provider or peer and is announced to
     another provider or peer.  See
     <xref target="I-D.ietf-grow-route-leak-problem-definition"/> and
     <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>.
     These are usually the result of misconfigured or absent BGP route
     filtering, or lack of coordination between two BGP speakers. </t>

     <t> <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>
     describes a method of marking and detecting leaks which relies on
     operator maintained markings.  Unfortunately, in most cases, a
     leaking router will likely also be misconfigured to mark
     incorrectly. </t>

     <t>This document specifies a new BGP Capability Code,
     <xref target="RFC5492"></xref> Sec 4, which two BGP speakers MAY
     use to ensure that they MUST agree on their relationship;
     i.e. customer and provider or peers.  Either or both may optionally
     be configured to require that this option be exchanged for the BGP
     Open to succeed. </t>

     <t> Once the BGP neighbors have agreed on their respective roles,
     routes may be marked as described in
     <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>, and
     leaks may be detected with reasonable assurance. </t>
   </section>

   <section anchor="bgp_role" title="BGP Role">
     <t>BGP Role is new mandatory configuration option. It reflects the
     verbal real-world agreement between two BGP speakers about their
     business relationship.</t>

     <t>For now, possible Role values are: <list style="symbols">
         <t>Provider - speaker is a transit provider to neighbor;</t>
         <t>Customer - speaker is customer of neighbor;</t>
         <t>Peer     - speaker and neighbor are peers;</t>
         <t>Internal - speaker is part of an internal AS of an
         organization which has multiple ASs, confederation, ...</t>
       </list> </t>
     <t>Since BGP Role reflects the relationship between two
     neighbors, it can also be used for more than route leak
     mitigation.</t>
   </section>

   <section anchor="capability" title="Role capability">
     <t> The TLV (type, length, value) of the BGP Role capability
     are: <list style="symbols">
     <t> Type   - &lt;TBD1&gt;;</t>
     <t> Length - 1 (octet);</t>
     <t> Value - integer corresponding to speaker' BGP Role.</t>
     </list></t>
     <texttable anchor="values" title="Predefined BGP Role Values" suppress-title="false">
     <ttcol align="center"> Value </ttcol>
     <ttcol align="left"> Role name </ttcol>
     <c> 0   </c> <c> Undefined </c>
     <c> 1   </c> <c> Sender is Peer      </c>
     <c> 2   </c> <c> Sender is Provider  </c>
     <c> 3   </c> <c> Sender is Customer  </c>
     <c> 4   </c> <c> Sender is Internal  </c>
     </texttable>

     </section>

   <section anchor="correctness" title="Role correctness">
     <t><xref target="bgp_role"/> described how BGP Role is a reflection
     of the relationship between two BGP speakers. But the presence of
     BGP Role doesn't automatically guarantee role correctness.</t>

     <t>To enforce correctness using the BGP Role check, there is a set
     of constrains on how neighbors' BGP Roles MUST corresponded.  Of
     course, each speaker MUST announce and accept the BGP Role
     capability in the BGP OPEN message exchange.</t>

     <t> If a speaker receives a BGP Role capability, it SHOULD check
     value of received capability with its own BGP Role. The allowed
     pairings are (first is its own Role, second is received
     Role): <list style="symbols">
     <t> (Peer, Peer);  </t>
     <t> (Provider, Customer); </t>
     <t> (Customer, Provider); </t>
     <t> (Internal, Internal); </t>
     </list> In all other cases speaker MUST send a Role Mismatch
     Notification (code 2, sub-code &lt;TBD2&gt;).</t>

     <section title="Strict mode" anchor="strict">
     <t>A new BGP configuration option "strict mode" is defined with
     values of true or false. If set to true, then the speaker MUST
     reject connection with peers which do not announce BGP Role
     capability in their OPEN message. If a speaker rejects a
     connection, it MUST send a Connection Rejected Notification
     <xref target="RFC4486"/> (Notification with error code 6, subcode
     5).  But by default strict mode SHOULD be set with false for
     backward compatibility with BGP neighbors, that do not yet support
     this mechanism.</t>
    </section>
   </section>

   <section anchor="considerations" title="Additional Considerations">
     <t>As BGP Role reflects the relationship between neighbors, it can
     also have other uses.  As an example, BGP Role might affect route
     priority, or be used to distinguish borders of network if a network
     consists of multiple AS</t>
     <t>Though such uses may be worthwhile, they are not the goal of
      this document.  Note that such uses would require local policy
      control. </t>
   </section>


   <section anchor="IANA" title="IANA Considerations">
     <t>This document defines a new Capability Codes option, named "BGP
     Role", assigned value &lt;TBD1&gt; [to be removed upon publication:
     http://www.iana.org/assignments/capability-codes/capability-codes.xhtml]
     <xref target="RFC5492"/>. The length of this capability is 1. </t>

     <t>The BGP Role capability includes a Value field, for which IANA
     is asked to create and maintain a new sub-registry called "BGP Role
     Value". Initial values of this registry are to be populated with
     the Values in <xref target="values"/>. Future assignments are to be
     made upon Standard action procedure <xref target="RFC5226"/>.
     Assignments consist of Value and corresponding Role name.</t>

     <t>Finally, this document defines new Notification option, named
     "Role Mismatch", assigned value &lt;TBD2&gt; from OPEN message
     Error subcodes [to be removed upon publication:
     http://www.iana.org/assignments/bgp-parameters/bgp-parameters.xhtml#bgp-parameters-6]
     <xref target="RFC4271"/>.</t>
   </section>

   <section anchor="Security" title="Security Considerations">
     <t>The BGP Role capability can be used for tagging of routes to
     avoid route leaks.</t>

     <t>Deliberate sending of a known conflicting BGP Role under strict
     mode could be used to sabotage a BGP connection.  This is easily
     detectable.</t>

     <t>BGP Role is disclosed only to an immediate BGP neighbor, so it
     will not itself reveal any sensitive information to third
     parties.</t>

     <t>On the other hand, ensuring that the BGP business relationship
     is strongly asserted and tested lends more credence to the leakage
     of business relationships in
     <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>.</t>

   </section>
 </middle>

 <back>
   <references title="Normative References">
     &RFC2119;
     &RFC4271;
     &RFC4486;
     &RFC5492;
   </references>

   <references title="Informative References">
     &RFC5226;
     &I-D.ietf-grow-route-leak-problem-definition;
     &I-D.ietf-idr-route-leak-detection-mitigation;
  </references>
 </back>
</rfc>


