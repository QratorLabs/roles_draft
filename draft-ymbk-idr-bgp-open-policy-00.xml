<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC4271 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4271.xml">
<!ENTITY RFC4486 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4486.xml">
<!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
<!ENTITY RFC5492 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5492.xml">
<!ENTITY I-D.ietf-grow-route-leak-problem-definition SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-grow-route-leak-problem-definition-03.xml">
<!ENTITY I-D.ietf-idr-route-leak-detection-mitigation SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-idr-route-leak-detection-mitigation-01.xml">
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" docName="draft-ymbk-idr-bgp-open-policy-00" ipr="trust200902">
 <front>

   <title abbrev="BGP Role"> BGP Open Marking Customer/Peer </title>

   <author fullname="Alexander Azimov" initials="A"
           surname="Azimov">
     <organization>Qrator Labs</organization>
     <address>
       <email>aa@qrator.net</email>
     </address>
   </author>

   <author fullname="Eugene Bogomazov" initials="E"
           surname="Bogomazov">
     <organization>Qrator Labs</organization>
     <address>
       <email>eb@qrator.net</email>
     </address>
   </author>

   <author fullname="Randy Bush" initials="R"
           surname="Bush">
     <organization>Internet Initiative Japan</organization>
     <address>
       <email>randy@psg.com</email>
     </address>
   </author>

   <date year="2016"/>
   <area>Routing</area>

   <keyword>Route leak</keyword>
   <keyword>BGP role</keyword>

   <abstract>
     <t>Route Leaks are propagation of BGP prefixes which violate assumptions
     of BGP topology relationships; e.g. passing a route learned from one
     peer to another peer or a transit provider, passing a route learned
     from one transit provider to another transit provider or a peer.
     This document enhances BGP Open to establish agreement of the (peer,
     customer, transit) relationship of the two BGP peers.  Propagated
     routes are then marked with that relationship, and if the markings
     are propagated, allowing detection of route leaks. </t>
   </abstract>

   <note title="Requirements Language">
     <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
     "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" are to be
     interpreted as described in <xref target="RFC2119">RFC 2119</xref>
     only when they appear in all upper case.  They may also appear in lower
     or mixed case as English words, without normative meaning. </t>
   </note>
 </front>

 <middle>
   <section title="Introduction" anchor="intro">
     <t> For the purposes of this document BGP route leaks are when BGP route
     was learned from transit provider or peer and is announced to another
     provider or peer.  See <xref target="I-D.ietf-grow-route-leak-problem-definition"/>
     and <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>.  These are
     usually the result of misconfigured or absent BGP route filtering. </t>

     <t> <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/> describes a method of
     marking and detecting leaks which relies on operator maintained
     markings.  Unfortunately, in most cases, a leaking router will likely
     also be misconfigured to mark incorrectly. </t>

     <t>This document specifies a new BGP Capability Code (see
     <xref target="RFC5492"> RFC 5492 </xref> section 4) through which the two BGP
     speakers MUST agree on their relationship; i.e. customer and provider or
     peers.  Either side may optionally be configured to require that this
     option be exchanged for the BGP Open to succeed. </t>

     <t> Once the BGP peers have agreed on their respective roles, routes will
     be marked as described in <xref target="I-D.ietf-idr-route-leak-detection-mitigation"/>,
     and leaks may be detected with reasonable assurance. </t>
   </section>

   <section anchor="bgp_role" title="BGP Role">
     <t>BGP Role is new mandatory configuration option. It reflects the verbal
     real-world agreement between two BGP neighbors about their business relation.</t>

     <t>For now, possible Role values are: <list style="symbols">
         <t>Provider - neighbor is your service provider;</t>
         <t>Customer - neighbor is your customer;</t>
         <t>Peer     - neighbor is your peer;</t>
         <t>Internal - neighbor is part of your AS or company (in case of
         multiple AS);</t>
       </list> Since Role reflects only relation state between two neighbors, it
       can be used not only for route leak mitigation.</t>
   </section>

   <section anchor="correctness" title="Role correctness">
     <t> In <xref target="bgp_role"/> was mentioned that BGP Role is a reflection
     of relation between two BGP speakers. But presence of Role doesn't automatically
     guarantee Role correctness.</t>
     <t> That's is why this document proposed a set of constrains how neighbors' Roles
     must be corresponded to each other. To make correctness Roles check possible,
     speaker MUST add new "Role" capability <xref target="RFC5492"/> in OPEN message,
     that contain speaker' Role.</t>
   <section anchor="capability" title="Role capability">
     <t> TLV (type, length, value) of Role announce capability are next: <list
     style="symbols">
     <t> Type   - &lt;TBD1&gt;;</t>
     <t> Length - 1 (octet);</t>
     <t> Value  - integer corresponding to speaker' Role.</t>
     </list></t>
     <t> If speaker received Role capability, it SHOULD check value of
     received capability with its own Role. The correct pair are (first is its own Role,
     second is received Role): <list style="symbols">
     <t> (Peer, Peer);  </t>
     <t> (Provider, Customer); </t>
     <t> (Customer, Provider); </t>
     <t> (Internal, Internal); </t>
     </list> In all other cases speaker MUST send Role Mismatch Notification (code 2,
     sub-code &lt;TBD2&gt;).</t>
     </section>
     <section title="Strict mode" anchor="strict">
     <t> Also this document proposes new BGP configuration option "strict mode". It can
     accept two values: true or false. If this option is set with true, then speaker MUST
     reject connection with peers, that don't add Role announce capability in their
     OPEN message. If speaker reject a connection, it MUST send Connection Rejected
     Notification <xref target="RFC4486"/> (Notification with error code 6, subcode 5).
     But by default strict mode SHOULD be set with false for backward compatibility with
     BGP neighbors, that haven't already supported this mechanism.</t>
    </section>
   </section>

   <section anchor="considerations" title="Additional Considerations">
     <t>Role can be used not only for route leak mitigation. As it reflects the relationship
     between neighbors, it can be used further to solve another tasks. As an example,
     role may affect on route priority.</t>
     <t>Although such a solution may be good, its proposal is not the task of this document.
      Meanwhile, decision for such a usage may be accept only with local policy approval. </t>
   </section>


   <section anchor="IANA" title="IANA Considerations">
     <t>This memo also defines a new Capability Codes option, named "Role announce", assigned value
     &lt;TBD1&gt; [to be removed upon publication:
     http://www.iana.org/assignments/capability-codes/capability-codes.xhtml]
     <xref target="RFC5492"/>. The length of this capability is 1. This capability
     also includes value field, for which IANA is to create and maintain a new
     sub-registry called "BGP Role". Initial values of this field are given below;
     future assignments are to be made upon Standard action procedure <xref target="RFC5226"/>.
     Assignments consist of value and corresponding Role name. </t>
     <texttable title="Predefined BGP Role values" suppress-title="false">
     <ttcol align="center"> Value </ttcol>
     <ttcol align="center"> Role name </ttcol>
     <c> 0   </c> <c> Undefined </c>
     <c> 1   </c> <c> Peer      </c>
     <c> 2   </c> <c> Provider  </c>
     <c> 3   </c> <c> Customer  </c>
     <c> 4   </c> <c> Internal  </c>
     </texttable>

     <t>Finally, this document defines new Notification option, named
     "Role Mismatch", assigned value &lt;TBD2&gt; from OPEN message Error subcodes
     [to be removed upon publication:
     http://www.iana.org/assignments/bgp-parameters/bgp-parameters.xhtml#bgp-parameters-6]
     <xref target="RFC4271"/>.</t>
   </section>

   <section anchor="Security" title="Security Considerations">
     <t>This document proposes a mechanism for avoiding route leaks, that are
     result of misconfiguration. That includes preventing route leaks creation inside AS (company)
     and route leak detection, if route was leaked by third party.</t>

     <t> However, detection of routes with malformed Local Announce attribute should
     be considered in future works. </t>

     <t>Finally, Role is disclosed only to its neighbor, so it will not reveal any
     sensitive information to other parties. </t>
   </section>
 </middle>

 <back>
   <references title="Normative References">
     &RFC2119;
     &RFC4271;
     &RFC4486;
     &RFC5492;
   </references>

   <references title="Informative References">
     &RFC5226;
     &I-D.ietf-grow-route-leak-problem-definition;
     &I-D.ietf-idr-route-leak-detection-mitigation;
  </references>
 </back>
</rfc>


